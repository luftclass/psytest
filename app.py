import streamlit as st

# 1. í˜ì´ì§€ ì„¤ì •
st.set_page_config(page_title="ì‹¬ì¸µ ì„±í–¥ ë¶„ì„ ë¦¬í¬íŠ¸ (Pro)", page_icon="ğŸ§ ", layout="centered")

# 2. CSS ìŠ¤íƒ€ì¼ë§ (ë‹¤í¬ëª¨ë“œ ì™„ë²½ ì§€ì› + ê°€ë…ì„±)
st.markdown("""
    <style>
    .main-header {font-size: 30px; font-weight: bold; margin-bottom: 10px;}
    .result-box {
        padding: 20px; 
        border-radius: 12px; 
        margin-bottom: 20px;
        background-color: #f8f9fa; 
        border: 1px solid #e9ecef;
        color: #333333 !important; /* ë‹¤í¬ëª¨ë“œ ê¸€ììƒ‰ íŒ¨ì¹˜ */
    }
    .stRadio label {font-size: 17px !important;}
    .big-score {font-size: 24px; font-weight: bold; color: #1565C0;}
    </style>
""", unsafe_allow_html=True)

# 3. ì„¸ì…˜ ìƒíƒœ ì´ˆê¸°í™”
if 'current_idx' not in st.session_state:
    st.session_state.current_idx = 0
if 'lie_score' not in st.session_state:
    st.session_state.lie_score = 0
if 'main_score' not in st.session_state:
    st.session_state.main_score = 0
if 'finished' not in st.session_state:
    st.session_state.finished = False

# 4. ì§ˆë¬¸ ë°ì´í„° (ì´ 25ë¬¸í•­: íƒ€ë‹¹ì„± 4 + ë³¸ì§ˆë¬¸ 21)
questions = [
    ("1. ì‚¬ì†Œí•œ ë§ˆì°°ì´ ìƒê²¼ì„ ë•Œ, êµ³ì´ ìƒí™©ì„ í‚¤ìš°ê¸°ë³´ë‹¤ ì¡°ìš©íˆ ë„˜ì–´ê°€ëŠ” í¸ì´ ë” íš¨ìœ¨ì ì´ë¼ê³  ëŠë‚€ë‹¤.", "main"),
    ("2. ë‚˜ëŠ” ì‚´ë©´ì„œ ë‹¨ í•œ ë²ˆë„, ìƒí™©ì„ ëª¨ë©´í•˜ê¸° ìœ„í•´ ì‚¬ì†Œí•œ ê±°ì§“ë§ì´ë‚˜ í•‘ê³„ë¥¼ ëŒ€ë³¸ ì ì´ ì—†ë‹¤.", "lie"),
    ("3. ê²½ì œì ìœ¼ë¡œ ë¶€ë‹´ì´ ë  ë•ŒëŠ” ì•½ì†ì´ë‚˜ ì˜ë¬´ë„ ì¬ì¡°ì •ì´ í•„ìš”í•˜ë‹¤ê³  ìƒê°í•œë‹¤.", "main"),
    ("4. ë‹¨ì²´ì— ë¬¸ì œê°€ ìƒê²¼ì„ ë•Œ, ì¡°ì§ì„ ìœ„í•´ ê°œì¸ì´ ì±…ì„ì„ ë– ì•ˆëŠ” ê²ƒë„ í˜„ì‹¤ì ì¸ ì„ íƒì¼ ìˆ˜ ìˆë‹¤.", "main"),
    ("5. ë‚˜ëŠ” ì‚´ë©´ì„œ ë§ˆìŒì†ìœ¼ë¡œì¡°ì°¨ íƒ€ì¸ì„ í‰ë³´ê±°ë‚˜ ë¯¸ì›Œí•œ ì ì´ ë‹¨ í•œ ë²ˆë„ ì—†ë‹¤.", "lie"),
    ("6. ê²½ìŸ ìƒí™©ì—ì„œëŠ” ì •ë³´ í™œìš© ëŠ¥ë ¥ë„ í•˜ë‚˜ì˜ ì‹¤ë ¥ì´ë¼ê³  ìƒê°í•œë‹¤.", "main"),
    ("7. ê°€ê¹Œìš´ ì‚¬ëŒì˜ ìŠ¬í””ì„ ì´í•´ëŠ” í•˜ì§€ë§Œ, ê°ì •ì— ì˜¤ë˜ ë¨¸ë¬´ë¥´ëŠ” ê²ƒì€ ìƒì‚°ì ì´ì§€ ì•Šë‹¤ê³  ëŠë‚€ë‹¤.", "main"),
    ("8. ì•„ë¬´ë„ ë³´ì§€ ì•ŠëŠ” ìƒí™©ì´ë¼ë©´, êµ³ì´ ì—„ê²©í•œ ê·œì¹™ ì¤€ìˆ˜ì— ì–½ë§¤ì¼ í•„ìš”ëŠ” ì—†ë‹¤ê³  ë³¸ë‹¤.", "main"),
    ("9. ë¬¸ì œê°€ ì»¤ì§€ì§€ ì•Šë„ë¡ ìƒí™© ì„¤ëª…ì„ ì¡°ì •í•˜ëŠ” ê²ƒì€ ì‚¬íšŒìƒí™œì˜ ê¸°ìˆ  ì¤‘ í•˜ë‚˜ë¼ê³  ìƒê°í•œë‹¤.", "main"),
    ("10. ì¤‘ìš”í•œ ê¸°íšŒê°€ ìƒê¸°ë©´ ê¸°ì¡´ ì¼ì •ì€ ì–´ëŠ ì •ë„ ì¡°ì •í•  ìˆ˜ ìˆë‹¤ê³  ë³¸ë‹¤.", "main"),
    ("11. ê²°ê³¼ê°€ ì¢‹ë‹¤ë©´ ê³¼ì •ì€ ì–´ëŠ ì •ë„ ìœ ì—°í•˜ê²Œ í•´ì„ë  ìˆ˜ ìˆë‹¤ê³  ìƒê°í•œë‹¤.", "main"),
    ("12. ë‚˜ëŠ” ë¬´ë¡€í•˜ê±°ë‚˜ ë¶€ë‹¹í•œ ëŒ€ìš°ë¥¼ ë°›ì•„ë„, í™”ê°€ ë‚˜ê±°ë‚˜ ì§œì¦ì´ ë‚œ ì ì´ ì „í˜€ ì—†ë‹¤.", "lie"),
    ("13. ì‚¬íšŒì  í”¼í•´ëŠ” ê°œì¸ì˜ íŒë‹¨ ì±…ì„ë„ ì¼ì • ë¶€ë¶„ í¬í•¨ëœë‹¤ê³  ë³¸ë‹¤.", "main"),
    ("14. ê°ˆë“± ìƒí™©ì—ì„œëŠ” ì§„ì‹¤í•œ ê°ì •ë³´ë‹¤ ìƒí™©ì„ ì›ë§Œí•˜ê²Œ ì •ë¦¬í•˜ëŠ” ë°©ì‹ì´ ë” ì¤‘ìš”í•˜ë‹¤ê³  ëŠë‚€ë‹¤.", "main"),
    ("15. ê·œì¹™ì€ ìƒí™©ì— ë”°ë¼ ì¡°ì •ë  ìˆ˜ ìˆë‹¤ê³  ìƒê°í•˜ëŠ” í¸ì´ë‹¤.", "main"),
    ("16. ë‚˜ëŠ” í•´ì•¼ í•  ì¼ì´ ìˆì„ ë•Œ, ê·€ì°®ì•„ì„œ ë¯¸ë£¨ê³  ì‹¶ë‹¤ëŠ” ìœ í˜¹ì„ ëŠê»´ë³¸ ì ì´ ë‹¨ í•œ ë²ˆë„ ì—†ë‹¤.", "lie"),
    ("17. ì§ì¥ì—ì„œëŠ” ê°œì¸ ê°ì •ë³´ë‹¤ ì—­í•  ìˆ˜í–‰ì´ ìš°ì„ ì´ë¼ê³  ìƒê°í•œë‹¤.", "main"),
    ("18. í° ì„±ê³¼ë¥¼ ì–»ìœ¼ë ¤ë©´ ì¼ì • ìˆ˜ì¤€ì˜ ìœ„í—˜ì€ ê°ìˆ˜í•´ì•¼ í•œë‹¤ê³  ë¯¿ëŠ”ë‹¤.", "main"),
    ("19. ê³µê°œì ìœ¼ë¡œ ì²´ë©´ì´ ì†ìƒë˜ëŠ” ìƒí™©ì€ ì´í›„ ê´€ê³„ì—ì„œ ë°˜ë“œì‹œ ì •ë¦¬ê°€ í•„ìš”í•˜ë‹¤ê³  ìƒê°í•œë‹¤.", "main"),
    ("20. ëª¨ì„ì—ì„œ ë¶„ìœ„ê¸°ë¥¼ ì‚´ë¦¬ê¸° ìœ„í•´ ì–´ëŠ ì •ë„ì˜ ì •ë³´ ê³µìœ ëŠ” í•„ìš”í•˜ë‹¤ê³  ëŠë‚€ë‹¤.", "main"),
    ("21. ëœ»ë°–ì˜ ì´ë“ì´ ìƒê²¼ì„ ë•Œ, ê·¸ ì²˜ë¦¬ ê¸°ì¤€ì€ ìƒí™©ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤ê³  ìƒê°í•œë‹¤.", "main"),
    ("22. ë¶€íƒì„ ì˜ ê±°ì ˆí•˜ì§€ ëª»í•˜ëŠ” ì‚¬ëŒì—ê²Œ ìš”ì²­í•˜ëŠ” ê²ƒë„ ì¼ì¢…ì˜ í˜‘ë ¥ ë°©ì‹ì´ë¼ê³  ë³¸ë‹¤.", "main"),
    ("23. ì˜¤ë˜ëœ ì¼ì— ëŒ€í•´ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ê³¼ë¥¼ ìš”êµ¬ë°›ëŠ” ê²ƒì€ ë¶€ë‹´ìŠ¤ëŸ½ë‹¤ê³  ëŠë‚€ë‹¤.", "main"),
    ("24. ì œë„ì˜ ë¹ˆí‹ˆì„ í™œìš©í•˜ëŠ” ê²ƒì€ ëŠ¥ë ¥ì˜ í•œ í˜•íƒœë¼ê³  ë°›ì•„ë“¤ì¼ ìˆ˜ ìˆë‹¤.", "main"),
    ("25. ì¥ê¸°ì ìœ¼ë¡œëŠ” ê³¼ì •ë„ ì¤‘ìš”í•˜ì§€ë§Œ, ê²°êµ­ ì‚¬ëŒë“¤ì€ ê²°ê³¼ë¡œ í‰ê°€ë°›ëŠ”ë‹¤ê³  ìƒê°í•œë‹¤.", "main")
]

# ì œëª©
st.title("ğŸ§  ì„±í–¥ ë° ê°€ì¹˜ê´€ ì •ë°€ ë¶„ì„")
st.markdown("---")

# --------------------------------------------------------------------------------
# ê²°ê³¼ í™”ë©´ (5ë‹¨ê³„ ì„¸ë¶„í™”)
# --------------------------------------------------------------------------------
if st.session_state.finished:
    lie_score = st.session_state.lie_score
    main_score = st.session_state.main_score
    
    # 1. ì‹ ë¢°ë„ ê²€ì¦ ì‹¤íŒ¨ (4ë¬¸í•­ * 4ì  = 16ì  ì´ìƒ)
    if lie_score >= 16:
        st.error(f"âš ï¸ **í”„ë¡œíŒŒì¼ë§ ë¶ˆê°€ (Invalid Profile)**")
        st.write(f"**íƒ€ë‹¹ë„ ì²™ë„(L-Scale):** {lie_score}ì  (ì„ê³„ì¹˜ 16ì  ì´ˆê³¼)")
        st.markdown("""
        **[ë¶„ì„ ì‹¤íŒ¨: ì‚¬íšŒì  ë°”ëŒì§ì„± í¸í–¥]**
        ì‘ë‹µ ë°ì´í„°ì—ì„œ ë³¸ì¸ì„ ì§€ë‚˜ì¹˜ê²Œ ë„ë•ì ìœ¼ë¡œ í¬ì¥í•˜ë ¤ëŠ” ë°©ì–´ ê¸°ì œê°€ ê°ì§€ë˜ì—ˆìŠµë‹ˆë‹¤.
        (ì˜ˆ: ì¸ê°„ì´ë¼ë©´ ëˆ„êµ¬ë‚˜ ê²ªëŠ” ê°ì •ì¡°ì°¨ ë¶€ì •í•¨)
        
        ì´ ìƒíƒœì—ì„œëŠ” ì •í™•í•œ ì„±í–¥ ë¶„ì„ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. **ì†”ì§í•œ íƒœë„ë¡œ ì¬ê²€ì‚¬ë¥¼ ê¶Œì¥í•©ë‹ˆë‹¤.**
        """)
        
    # 2. ê²°ê³¼ ë¶„ì„ ì„±ê³µ (ë³¸ë¬¸í•­ 21ê°œ * 5ì  = 105ì  ë§Œì )
    else:
        # Level 1: ê·¹ë„ì˜ ì´íƒ€ì£¼ì˜ (21 ~ 38ì )
        if main_score <= 38:
            st.success("ğŸŒ¿ **ìˆœìˆ˜ ê³µê°ì  ì´íƒ€ì£¼ì˜ì (Pure Altruist)**")
            st.caption(f"ì„±í–¥ ì§€ìˆ˜: {main_score} / 105 (ë§¤ìš° ë‚®ìŒ)")
            with st.expander("ğŸ“Š ìƒì„¸ ì‹¬ë¦¬ ë¦¬í¬íŠ¸ í™•ì¸", expanded=True):
                st.markdown("""
                * **í•µì‹¬ íŠ¹ì„±:** ìì•„(Self)ë³´ë‹¤ íƒ€ì(Other)ë¥¼ ìš°ì„ ì‹œí•˜ëŠ” ê²½í–¥ì´ ê·¹ë„ë¡œ ê°•í•©ë‹ˆë‹¤. ê±°ìš¸ ë‰´ëŸ°ì´ ê³¼í™œì„±í™”ë˜ì–´ ìˆì–´ íƒ€ì¸ì˜ ê³ í†µì„ ìì‹ ì˜ ê²ƒì²˜ëŸ¼ ëŠë‚ë‹ˆë‹¤.
                * **í–‰ë™ íŒ¨í„´:** ê°ˆë“± ìƒí™©ì—ì„œ 100% ì–‘ë³´í•˜ë©°, ìì‹ ì˜ ì´ìµì„ ì±™ê¸°ëŠ” ê²ƒì— ì£„ì±…ê°ì„ ëŠë‚ë‹ˆë‹¤. 'ì„±ì¸êµ°ì'ë¼ëŠ” í‰ì„ ë“£ìŠµë‹ˆë‹¤.
                * **âš ï¸ ì£¼ì˜:** **ë³‘ë¦¬ì  ì´íƒ€ì£¼ì˜(Pathological Altruism)**ë¡œ íë¥¼ ìœ„í—˜ì´ ìˆìŠµë‹ˆë‹¤. íƒ€ì¸ì—ê²Œ ì´ìš©ë‹¹í•˜ê¸° ì‰¬ìš°ë©°, ì‹¬ë¦¬ì  ì†Œì§„(Burnout)ì´ ë¹¨ë¦¬ ì˜µë‹ˆë‹¤.
                """)

        # Level 2: ì‚¬íšŒì  í˜‘ë ¥ì (39 ~ 55ì )
        elif main_score <= 55:
            st.info("ğŸ¤ **ì¡°í™”ë¡œìš´ ì‚¬íšŒì  í˜‘ë ¥ì (Harmonious Cooperator)**")
            st.caption(f"ì„±í–¥ ì§€ìˆ˜: {main_score} / 105 (ë‚®ìŒ)")
            with st.expander("ğŸ“Š ìƒì„¸ ì‹¬ë¦¬ ë¦¬í¬íŠ¸ í™•ì¸", expanded=True):
                st.markdown("""
                * **í•µì‹¬ íŠ¹ì„±:** ë†’ì€ ìš°í˜¸ì„±(Agreeableness)ì„ ë°”íƒ•ìœ¼ë¡œ ê³µë™ì²´ì˜ ê·œì¹™ê³¼ í™”í•©ì„ ì¤‘ìš”ì‹œí•©ë‹ˆë‹¤. ë„ë•ì  ë¯¼ê°ì„±ì´ ë†’ì•„ ì›ì¹™ì„ ì˜ ì§€í‚µë‹ˆë‹¤.
                * **í–‰ë™ íŒ¨í„´:** ìœµí†µì„±ë³´ë‹¤ëŠ” ì •ì§í•¨ì„ ì„ í˜¸í•©ë‹ˆë‹¤. ì£¼ë³€ ì‚¬ëŒë“¤ì—ê²Œ 'ë¯¿ì„ ìˆ˜ ìˆëŠ” ì‚¬ëŒ', 'ì°©í•œ ì‚¬ëŒ'ìœ¼ë¡œ ì‹ ë¢°ë¥¼ ì–»ìŠµë‹ˆë‹¤.
                * **âš ï¸ ì£¼ì˜:** ì§€ë‚˜ì¹˜ê²Œ ì›ì¹™ì„ ê³ ìˆ˜í•˜ë‹¤ê°€ ìœµí†µì„± ì—†ë‹¤ëŠ” í‰ê°€ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°€ë”ì€ 'ê±´ê°•í•œ ì´ê¸°ì‹¬'ë„ í•„ìš”í•©ë‹ˆë‹¤.
                """)

        # Level 3: ì ì‘ì  í˜„ì‹¤ì£¼ì˜ì (56 ~ 72ì )
        elif main_score <= 72:
            st.info("âš–ï¸ **ì ì‘ì  í˜„ì‹¤ì£¼ì˜ì (Adaptive Realist)**")
            st.caption(f"ì„±í–¥ ì§€ìˆ˜: {main_score} / 105 (ë³´í†µ)")
            with st.expander("ğŸ“Š ìƒì„¸ ì‹¬ë¦¬ ë¦¬í¬íŠ¸ í™•ì¸", expanded=True):
                st.markdown("""
                * **í•µì‹¬ íŠ¹ì„±:** ê°€ì¥ ê· í˜• ì¡íŒ ìœ í˜•ì…ë‹ˆë‹¤. ìƒí™©ì— ë”°ë¼ ë„ë•ì  ëª…ë¶„ê³¼ ì‹¤ë¦¬ì  ì´ìµ ì‚¬ì´ì—ì„œ ìœ ì—°í•˜ê²Œ ìŠ¤ìœ„ì¹­(Switching) í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                * **í–‰ë™ íŒ¨í„´:** í‰ì†Œì—ëŠ” ë„ë•ì ì´ì§€ë§Œ, ì†í•´ê°€ í° ìƒí™©ì—ì„œëŠ” í•©ë¦¬ì ì¸ í•‘ê³„ë¥¼ ì°¾ì•„ ì‹¤ë¦¬ë¥¼ ì±™ê¹ë‹ˆë‹¤. ì‚¬íšŒ ì ì‘ë ¥ì´ ê°€ì¥ ë›°ì–´ë‚©ë‹ˆë‹¤.
                * **âš ï¸ ì£¼ì˜:** ì¼ê´€ì„±ì´ ë¶€ì¡±í•´ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¤‘ìš”í•œ ê°€ì¹˜ê´€ì— ëŒ€í•´ì„œëŠ” íƒ€í˜‘í•˜ì§€ ì•ŠëŠ” ëª¨ìŠµì„ ë³´ì—¬ì£¼ëŠ” ê²ƒì´ ì¥ê¸°ì  ì‹ ë¢°ì— ë„ì›€ì´ ë©ë‹ˆë‹¤.
                """)

        # Level 4: í•©ë¦¬ì  ì „ëµê°€ (73 ~ 89ì )
        elif main_score <= 89:
            st.warning("â™Ÿï¸ **ëƒ‰ì² í•œ í•©ë¦¬ì  ì „ëµê°€ (Rational Strategist)**")
            st.caption(f"ì„±í–¥ ì§€ìˆ˜: {main_score} / 105 (ë†’ìŒ)")
            with st.expander("ğŸ“Š ìƒì„¸ ì‹¬ë¦¬ ë¦¬í¬íŠ¸ í™•ì¸", expanded=True):
                st.markdown("""
                * **í•µì‹¬ íŠ¹ì„±:** ê°ì •ì„ 'ë¹„íš¨ìœ¨ì ì¸ ë°ì´í„°'ë¡œ ê°„ì£¼í•©ë‹ˆë‹¤. ë¬¸ì œ í•´ê²°ê³¼ ëª©í‘œ ë‹¬ì„±ì„ ìµœìš°ì„  ê°€ì¹˜ë¡œ ë‘ë©°, ê³„ì‚°ì  ì‚¬ê³ ê°€ ë¹ ë¦…ë‹ˆë‹¤.
                * **í–‰ë™ íŒ¨í„´:** ê·œë²”ì„ ì§€í‚¤ê¸´ í•˜ì§€ë§Œ, ê·¸ê²ƒì´ ë‚˜ì—ê²Œ ì´ë“ì´ ë  ë•Œë§Œ ì§€í‚µë‹ˆë‹¤. ë¶ˆí•„ìš”í•œ ê°ì • ì†Œëª¨ë¥¼ ì°¨ë‹¨í•˜ê³  ì„±ê³¼ë¥¼ ëƒ…ë‹ˆë‹¤.
                * **âš ï¸ ì£¼ì˜:** 'ì •ì´ ì—†ë‹¤', 'ê³„ì‚°ì ì´ë‹¤'ë¼ëŠ” í‰ê°€ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—…ë¬´ì  ëŠ¥ë ¥ì€ ì¸ì •ë°›ì§€ë§Œ, ì¸ê°„ì ì¸ ë§¤ë ¥ì€ ë–¨ì–´ì§ˆ ìˆ˜ ìˆìœ¼ë‹ˆ ê³µê°í•˜ëŠ” ì²™(Social Skill)ì´ë¼ë„ í•„ìš”í•©ë‹ˆë‹¤.
                """)

        # Level 5: ë§ˆí‚¤ì•„ë²¨ë¦¬ì  ì§€ë°°ì (90 ~ 105ì )
        else:
            st.error("ğŸ¦… **ë§ˆí‚¤ì•„ë²¨ë¦¬ì  ì§€ë°°ì (Machiavellian Ruler)**")
            st.caption(f"ì„±í–¥ ì§€ìˆ˜: {main_score} / 105 (ë§¤ìš° ë†’ìŒ)")
            with st.expander("ğŸ“Š ìƒì„¸ ì‹¬ë¦¬ ë¦¬í¬íŠ¸ í™•ì¸", expanded=True):
                st.markdown("""
                * **í•µì‹¬ íŠ¹ì„±:** ë„êµ¬ì  í•©ë¦¬ì„±(Instrumental Rationality)ì´ ê·¹ëŒ€í™”ëœ ìƒíƒœì…ë‹ˆë‹¤. íƒ€ì¸ì„ ëª©ì  ë‹¬ì„±ì„ ìœ„í•œ 'ìì›'ìœ¼ë¡œ ì¸ì‹í•˜ë©°, ì¡°ì¢…(Manipulation)ì— ëŠ¥ìˆ™í•©ë‹ˆë‹¤.
                * **í–‰ë™ íŒ¨í„´:** ì£„ì±…ê° ì—†ì´ ê±°ì§“ë§ì„ ì „ëµì ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤. ìœ„ê¸° ìƒí™©ì—ì„œ ê°ì •ì— íœ˜ë‘˜ë¦¬ì§€ ì•Šê³  ê°€ì¥ ëƒ‰í˜¹í•˜ê³  íš¨ìœ¨ì ì¸ íŒë‹¨ì„ ë‚´ë¦½ë‹ˆë‹¤.
                * **âš ï¸ ì£¼ì˜:** ë‹¨ê¸°ì ìœ¼ë¡œëŠ” ì„±ê³µí•  ìˆ˜ ìˆìœ¼ë‚˜, ì¥ê¸°ì ìœ¼ë¡œëŠ” **ì‚¬íšŒì  ê³ ë¦½**ì„ ì´ˆë˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì§„ì •ì„± ì—†ëŠ” ê´€ê³„ëŠ” ê²°êµ­ ë¬´ë„ˆì§ì„ ëª…ì‹¬í•´ì•¼ í•©ë‹ˆë‹¤.
                """)

    # ì¬ì‹œì‘ ë²„íŠ¼
    if st.button("ğŸ”„ í…ŒìŠ¤íŠ¸ ë‹¤ì‹œ í•˜ê¸°", type="secondary"):
        st.session_state.current_idx = 0
        st.session_state.lie_score = 0
        st.session_state.main_score = 0
        st.session_state.finished = False
        st.rerun()

# --------------------------------------------------------------------------------
# ì§ˆë¬¸ ì§„í–‰ í™”ë©´
# --------------------------------------------------------------------------------
else:
    idx = st.session_state.current_idx
    q_text, q_type = questions[idx]
    
    # ì§„í–‰ë¥ 
    progress = int((idx / len(questions)) * 100)
    st.progress(progress, text=f"ë¶„ì„ ì§„í–‰ë¥  {progress}%")
    
    # ì§ˆë¬¸ ë°•ìŠ¤
    st.markdown(f"""
        <div class="result-box">
            <p style="font-size: 20px; text-align: center; margin: 0; font-weight: 500;">{q_text}</p>
        </div>
    """, unsafe_allow_html=True)
    
    # ë‹µë³€ ì„ íƒ
    choice = st.radio(
        "ê°€ì¥ ì¼ì¹˜í•˜ëŠ” í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”:",
        options=[1, 2, 3, 4, 5],
        format_func=lambda x: {
            1: "ì „í˜€ ì•„ë‹ˆë‹¤ (1ì )",
            2: "ì•„ë‹ˆë‹¤ (2ì )",
            3: "ë³´í†µì´ë‹¤ (3ì )",
            4: "ê·¸ë ‡ë‹¤ (4ì )",
            5: "ë§¤ìš° ê·¸ë ‡ë‹¤ (5ì )"
        }[x],
        index=None,
        key=f"q_{idx}"
    )
    
    # ë‹¤ìŒ ë²„íŠ¼
    if st.button("ë‹¤ìŒ ë¬¸í•­ >", type="primary", use_container_width=True):
        if choice is None:
            st.toast("âš ï¸ ë‹µë³€ì„ ì„ íƒí•´ì£¼ì„¸ìš”!")
        else:
            if q_type == "lie":
                st.session_state.lie_score += choice
            else:
                st.session_state.main_score += choice
            
            if idx + 1 < len(questions):
                st.session_state.current_idx += 1
                st.rerun()
            else:
                st.session_state.finished = True
                st.rerun()
